import { Meta, Story, Preview, Props } from "@storybook/addon-docs/blocks";
import { genColumns, genDataSource } from "../../utils/data/dataGenerators";

import {
  withKnobs,
  text,
  boolean,
  number,
  select
} from "@storybook/addon-knobs";
import { useState, useMemo } from "react";
import Table from "./";
import TableControlPanel from "../TableControlPanel";

<Meta
  title="Components/Table/Table"
  component={Table}
  decorators={[withKnobs]}
/>

# Table

Компонент `Table`.

Базовый компонент: [**antd/table**](https://ant.design/components/table/).

## Sandbox

<Preview>
  <Story name="Sandbox">
    {() => {
      const dataCount = number("data count", 100);
      const columnsCount = number("columns count", 10);
      //
      const sortable = boolean("sortable", true);
      const multipleSorting = boolean("multipleSorting", false);
      //
      const columns = useMemo(() => genColumns(columnsCount, true), [
        columnsCount
      ]);
      //
      let dataSource = useMemo(
        () => genDataSource(dataCount, columns, ["string"], true),
        [columns.length, dataCount]
      );
      //
      columns[0].fixed = "left";
      //
      columns[0].filters = [
        ...new Set(
          dataSource
            .filter(i => i.children)
            .map(item => item.children[0][columns[0].dataIndex])
        )
      ].map(item => ({
        text: item,
        value: item
      }));
      //
      return (
        <div>
          <Table
            height="450px"
            columns={columns}
            sortable={sortable}
            dataSource={dataSource}
            multipleSorting={multipleSorting}
            cellRenderProps={{ onClick: console.log }}
          />
        </div>
      );
    }}
  </Story>
</Preview>

## Basic

<Preview>
  <Story name="Basic">
    {() => {
      const dataSource = [
        {
          key: "1",
          name: "Mike",
          age: 32,
          address: "10 Downing Street"
        },
        {
          key: "2",
          name: "John",
          age: 42,
          address: "10 Downing Street"
        },
        {
          key: "3",
          name: "Leo",
          age: 31,
          address: "10 Downing Street"
        },
        {
          key: "4",
          name: "Tahir",
          age: 18,
          address: "Novoselitsa"
        },
        {
          key: "4",
          name: "Nikita",
          age: 19,
          address: "In Nastia"
        },
        {
          key: "5",
          name: "Pasha",
          age: 20,
          address: "Planohero"
        }
      ];
      //
      const columns = [
        {
          title: "Name",
          dataIndex: "name",
          key: "name"
        },
        {
          title: "Age",
          dataIndex: "age",
          key: "age"
        },
        {
          title: "Address",
          dataIndex: "address",
          key: "address"
        }
      ];
      //
      return <Table columns={columns} dataSource={dataSource} />;
    }}
  </Story>
</Preview>

## Async

<Preview>
  <Story name="Async">
    {() => {
      const columns = useMemo(() => genColumns(10, true), []);
      //
      let dataSource = useMemo(
        () => genDataSource(100, columns, ["link"], true),
        [columns.length]
      );
      //
      return <Table />;
    }}
  </Story>
</Preview>

<Props of={Table} />
